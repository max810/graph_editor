(this.webpackJsonpgraph_editor=this.webpackJsonpgraph_editor||[]).push([[0],{108:function(e,t,a){},110:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(7),c=a.n(r),l=(a(77),a(29)),s=a(19),i=a(38),d=a(39),u=a(42),m=a(24),p=a(15),y=a(65),f=a(66),b=a(51),h=a(67),g=a.n(h),j=a(9),k="GET_NODE_TYPES",O={nodeTypes:{}},v=Object(p.combineReducers)({nodes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case k:return Object(j.a)({},e,{nodeTypes:n});default:return e}}}),D={key:"User",storage:g.a,whitelist:["User"]},N=Object(b.a)(D,v),w=Object(p.createStore)(N,Object(f.composeWithDevTools)(Object(p.applyMiddleware)(y.a))),x=(Object(b.b)(w),w),A=a(8),E=a(20),C=a(10),S=a(49),T=a(134),I=a(140),B=a(139),K=a(36),_=a.n(K),M=(a(88),a(18)),P=a.n(M),L=a(50),G=a.n(L),W=function(){var e;return P.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.a.awrap(G.a.get("https://nnio-project.herokuapp.com/admin/layers_schemas"));case 2:return e=t.sent,console.log(e),t.abrupt("return",e);case 5:case"end":return t.stop()}}))},H=function(e){var t;return P.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,P.a.awrap(G.a.post("https://nnio-project.herokuapp.com/architecture/export-from-json-body",e));case 2:return t=a.sent,console.log(t),a.abrupt("return",t);case 5:case"end":return a.stop()}}))},J=Object(T.a)((function(){return{drawerPaper:{width:180}}})),R=Object(m.b)((function(e){return{nodeTypes:e.nodes.nodeTypes}}))((function(e){var t=J(),a=["#88dee3","#ffcf99","#82ab79","#ab93ad"],n=e.addNode,r=e.nodeTypes;return o.a.createElement(I.a,{variant:"permanent",anchor:"left",classes:{paper:t.drawerPaper}},r&&Object.keys(r).length&&Object.keys(r).map((function(e,t){return o.a.createElement(B.a,{key:_()(),onClick:function(){return n(e,a[t])}},e)})))})),U=a(43),F=a(143),V=a(141),X=a(142),Y=Object(T.a)((function(){return{drawerPaper:{width:200},content:{padding:10}}})),$=function(e){var t=Y(),a=e.node,r=e.onClose,c=e.onSubmit,l=Object(n.useState)(""),s=Object(U.a)(l,2),i=s[0],d=s[1],u=function(){return function(e){"keydown"===e.type&&"Escape"===e.key&&r()}};return o.a.createElement("div",null,o.a.createElement(I.a,{anchor:"right",open:!!a,onClose:u()},o.a.createElement("div",{className:t.list,role:"presentation",onClick:u(),onKeyDown:u()},o.a.createElement(F.a,{className:"content"},o.a.createElement(V.a,{htmlFor:"my-input"},"New node name"),o.a.createElement(X.a,{id:"my-input",onChange:function(e){return d(e.target.value)},value:i}),o.a.createElement(B.a,{onClick:function(){return c(i)}},"Change name")),o.a.createElement("div",{className:"content"},a.key))))},q="EXPORT_DIAGRAM",z=function(e){var t=e.nodeDataArray,a=e.linkDataArray,n=t.map((function(e){var t=[];return a.forEach((function(a,n){Object.entries(a)[1][1]===e.key&&(t[n]=Object.entries(a)[0][1])})),{name:"".concat(e.label),type:"".concat(e.type),inputs:t,params:{}}}));return console.log({date_created:(new Date).toISOString(),id:_()(),name:"myModel_1",layers:n}),{date_created:(new Date).toISOString(),id:_()(),name:"myModel_1",layers:n}};a(108),a(138),a(137),a(111),Object(T.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));var Q=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).nodeId=0,a.state={open:!1,contextNode:"",selectedNode:"",selectedNodeKeys:[],model:{nodeDataArray:[{key:"Alpha",label:"name",color:"pink",type:"Alpha"},{key:"Betta",label:"name2",color:"blue",type:"Betta"}],linkDataArray:[{from:"Alpha",to:"Betta"}]}},a.onEditPanelClose=function(){a.setState(Object(j.a)({},a.state,{contextNode:""}))},a.onNameChange=function(e){var t=a.state.model.nodeDataArray.map((function(t){return t.key===a.state.contextNode.key&&(t.label=e,console.log(t)),t}));console.log(t),a.setState(Object(j.a)({},a.state,{model:Object(j.a)({},a.state.model,{nodeDataArray:t})})),a.modelChangeHandler({eventType:""}),a.onEditPanelClose()},a.createDiagram=function(e){var t=C.GraphObject.make,n=t(C.Diagram,e,{initialContentAlignment:C.Spot.Center,"undoManager.isEnabled":!0});n.nodeTemplate=t(C.Node,"Vertical",new C.Binding("location","loc"),t(C.Shape,"Circle",{strokeWidth:0},new C.Binding("fill","color")),t(C.TextBlock,{position:"relative"},new C.Binding("text","label")),t(C.TextBlock,{margin:8,font:"Italic small-caps bold 13px Georgia, Serif"},new C.Binding("text","type")));var o=Object(E.a)(a);return n.addDiagramListener("ObjectSingleClicked",(function(e){var t=e.subject.part;if(!(t instanceof C.Link))if(1===e.diagram.selection.count)o.setState({selectedNode:t.data.key});else if(2===e.diagram.selection.count&&o.state.selectedNode){var a;console.log(o.state.model.linkDataArray),o.state.model.linkDataArray.map((function(e){console.log(e.to),console.log(t.data.key),e.to!==t.data.key||(a=!0)})),a?o.setState(Object(j.a)({},o.state,{model:Object(j.a)({},o.state.model,{linkDataArray:[].concat(Object(A.a)(o.state.model.linkDataArray),[{from:o.state.selectedNode,to:t.data.key}])})})):alert("Can not connect")}})),n.addDiagramListener("ObjectContextClicked",(function(e){var t=e.subject.part;t instanceof C.Link||o.setState(Object(j.a)({},o.state,{contextNode:t.data}),(function(){console.log(o.state.contextNode)}))})),n},a.removeNode=function(e){var t=a.state.model.nodeDataArray.findIndex((function(t){return t.key===e}));-1!==t&&a.setState(Object(j.a)({},a.state,{model:Object(j.a)({},a.state.model,{nodeDataArray:[].concat(Object(A.a)(a.state.model.nodeDataArray.slice(0,t)),Object(A.a)(a.state.model.nodeDataArray.slice(t+1)))})}))},a.removeLink=function(e){var t=a.state.model.linkDataArray.findIndex((function(t){return t.from===e.from&&t.to===e.to}));if(-1!==t)return Object(j.a)({},a.state,{model:Object(j.a)({},a.state.model,{linkDataArray:[].concat(Object(A.a)(a.state.model.linkDataArray.slice(0,t)),Object(A.a)(a.state.model.linkDataArray.slice(t+1)))})})},a.nodeSelectionHandler=function(e,t){if(t)a.setState(Object(j.a)({},a.state,{selectedNodeKeys:[].concat(Object(A.a)(a.state.selectedNodeKeys),[e])}));else{var n=a.state.selectedNodeKeys.findIndex((function(t){return t===e}));if(-1===n)return;a.setState(Object(j.a)({},a.state,{selectedNodeKeys:[].concat(Object(A.a)(a.state.selectedNodeKeys.slice(0,n)),Object(A.a)(a.state.selectedNodeKeys.slice(n+1)))}))}},a.addNode=function(e,t){var n="node"+a.nodeId,o=a.state.selectedNodeKeys.map((function(e){return{from:e,to:n}}));a.setState(Object(j.a)({},a.state,{model:Object(j.a)({},a.state.model,{nodeDataArray:[].concat(Object(A.a)(a.state.model.nodeDataArray),[{key:n,label:e||"New Node",color:t||"Blue",type:e||"Node type"}]),linkDataArray:o.length>0?Object(A.a)(a.state.model.linkDataArray).concat(o):Object(A.a)(a.state.model.linkDataArray)})})),a.nodeId+=1},a.modelChangeHandler=function(e){switch(e.eventType){case S.ModelChangeEventType.Remove:e.nodeData&&a.removeNode(e.nodeData.key),e.linkData&&a.removeLink(e.linkData)}},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.props.getNodeTypes()}},{key:"handleModal",value:function(e){this.setState({open:e.contextNode.label})}},{key:"render",value:function(){var e=this.state.model,t=this.props.exportArch;return o.a.createElement("section",null,o.a.createElement(R,{addNode:this.addNode}),o.a.createElement(S.GojsDiagram,{key:"gojsDiagram",diagramId:"myDiagramDiv",model:this.state.model,className:"myDiagram",createDiagram:this.createDiagram,onModelChange:this.modelChangeHandler,linkKeyProperty:"key"}),o.a.createElement(B.a,{style:{float:"right"},onClick:function(){return t(Object(j.a)({},e))}},"Export JSON"),o.a.createElement($,{node:this.state.contextNode,onClose:this.onEditPanelClose,onSubmit:this.onNameChange}))}}]),t}(o.a.Component),Z={getNodeTypes:function(){return function(e){var t,a,n;return P.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,P.a.awrap(W());case 3:a=o.sent,n=a.data,t=n,o.next=11;break;case 8:o.prev=8,o.t0=o.catch(0),console.log(o.t0);case 11:e({type:k,payload:t});case 12:case"end":return o.stop()}}),null,null,[[0,8]])}},exportArch:function(e){return function(t){var a,n,o;return P.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return a=z(e),console.log(a),r.next=4,P.a.awrap(H(JSON.stringify(a)));case 4:n=r.sent,o=n.data,t({type:q,payload:o});case 7:case"end":return r.stop()}}))}}},ee=Object(m.b)(null,Z)(Q),te=(a(109),function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement(m.a,{store:x},o.a.createElement("div",null,o.a.createElement(ee,null)))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(te,null),document.getElementById("app")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},72:function(e,t,a){e.exports=a(110)},77:function(e,t,a){}},[[72,1,2]]]);
//# sourceMappingURL=main.a59c6e8f.chunk.js.map